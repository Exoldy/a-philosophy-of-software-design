# **ГЛАВА 3. «ОНО РАБОТАЕТ» — ЭТОГО, БЛЯДЬ, МАЛО**
### **(Стратегическое vs Тактическое программирование)**

Один из главных скиллов нормального разработчика — это правильная ментальная модель. В большинстве команд поощряется тактическое мышление: «Давай быстрее, релиз горит, похер на красоту». Но если ты хочешь, чтобы твой проект не превратился в тыкву, тебе придется включить стратегию и потратить время на нормальный дизайн. В этой главе мы перетрем, почему стратегия в итоге выходит дешевле, а тактика — это путь в ад (хоть и быстрый).

## **3.1 Тактическое программирование (Синдром «Хуяк-хуяк и в продакшн»)**

Большинство программистов живут в режиме, который я называю **тактическим программированием**. Твоя единственная цель — закрыть тикет в Джире. Новая фича? Багфикс? Главное — чтобы заработало. Звучит логично, да? Что может быть важнее рабочего кода? Проблема в том, что с таким подходом ты никогда не построишь нормальную систему. Ты построишь карточный домик из костылей.

Тактика — это близорукость. У тебя есть дедлайн, и ты кладешь болт на планирование. Ты не ищешь лучшее решение, ты ищешь *быстрое*. Ты говоришь себе: «Ну, добавлю тут пару ифов, влеплю глобальную переменную, немного усложню, но зато успею к обеду».

Именно так системы превращаются в монстров. Как мы уже выяснили, сложность накапливается инкрементально. Никто не убивает проект одной строчкой кода (обычно). Это происходит через сотни мелких «временных решений». Если вся команда кодит тактически, сложность растет по экспоненте.

Очень скоро эти «быстрые фиксы» начинают стрелять тебе в ногу. Ты начинаешь жалеть, что срезал углы месяц назад. Но ты снова говоришь себе: «Сейчас нет времени на рефакторинг, надо пилить следующую фичу. Вот потом...». Спойлер: «потом» не наступит никогда. Ты лепишь патч на патч, костыль на костыль. Код превращается в помойку, которую страшно трогать. В итоге ты тратишь месяцы на то, чтобы просто заставить это говно работать.

Если ты работал над проектом дольше полугода, ты знаешь это чувство безысходности. Как только ты встал на скользкую дорожку тактики, свернуть с нее почти невозможно.

В каждой конторе есть такой персонаж — **Тактический Торнадо**. Это чувак, который пишет код быстрее всех, но абсолютно по-ублюдски. Когда нужно срочно выкатить фичу, он герой. Менеджмент его обожает. Но на самом деле Тактический Торнадо — это вредитель. Он оставляет за собой руины, которые потом разгребают другие (настоящие герои), из-за чего их работа кажется медленной. Торнадо не пишет код, он минирует проект.

## **3.2 Стратегическое программирование (Для тех, кто планирует жить)**

Первый шаг к тому, чтобы стать хорошим дизайнером ПО — осознать: **Рабочий код — это недостаточно**. Это, блядь, необходимый минимум, как штаны на работе. Нельзя добавлять ненужную сложность только ради скорости.

Главное — это долгосрочная архитектура. Большую часть времени мы расширяем существующий код, поэтому твоя задача — сделать так, чтобы расширять его было легко, а не больно. Твоя цель — **охуенный дизайн**, а рабочий код — это просто побочный эффект. Это и есть стратегическое программирование.

Стратегия требует инвестиций. Ты тратишь время сейчас, чтобы сэкономить его потом. Сначала ты просядешь по скорости (см. рис. 3.1), но на дистанции ты всех выебешь.

Инвестиции бывают активные: не писать первое, что пришло в голову, а потратить полчаса на поиск элегантного решения. Подумать, как этот класс будут менять через год. Написать, сука, документацию.

И пассивные инвестиции: когда видишь кусок говна в коде — убери его. Не проходи мимо, не ставь заплатку. Исправляй дизайн постоянно, по чуть-чуть. В отличие от тактиков, которые постоянно накидывают говна на вентилятор, стратеги постоянно чистят вентилятор.

## **3.3 Сколько инвестировать?**

Без фанатизма. Не надо пытаться спроектировать «Звезду Смерти» целиком до написания первой строчки кода (это Waterfall, и он мертв). Лучший подход — постоянные небольшие вложения. Трать около **10-20%** времени на дизайн и рефакторинг.

Это не сильно сдвинет дедлайны сейчас, но окупится стократно. Сначала проект займет на 10-20% больше времени. Но через пару месяцев ты заметишь, что пилишь фичи на 20% быстрее, чем тактики, которые уже увязли в своем болоте. Ты вернешь свои инвестиции быстрее, чем кажется.

![График 3.1](./figures/00011.jpeg)
*Рис. 3.1: В начале тактики (синяя линия) бегут быстрее, потому что им похер на качество. Но очень быстро их скорость падает, потому что код превращается в лапшу. Стратеги (красная линия) сначала тупят, но потом улетают в космос, потому что их система не сопротивляется изменениям.*

А вот если ты выберешь тактику... Сначала ты герой. Но скоро сложность начнет душить проект. Разработка замедлится не на 20%, а в разы. Если ты работал с убитым легаси, ты знаешь: любое изменение превращается в археологические раскопки в канализации.

## **3.4 Стартапы и инвестиции (Оправдание для говнокода)**

В стартапах любят говорить: «У нас нет времени на дизайн, нам надо релизить MVP вчера, инвесторы дышат в спину!». Для них даже 10% времени — это роскошь. Они выбирают тактику, лепят горбатого и говорят: «Вот станем богатыми — наймем штат сеньоров, и они всё перепишут».

Если ты работаешь в такой компании, знай: как только код превратился в спагетти, **его уже не починить**. Вы будете платить «налог на говнокод» вечно. И самое смешное: плохой дизайн начнет тормозить вас еще до первого релиза. Тактика не поможет вам выиграть гонку, она просто прострелит вам колеса на старте.

И еще кое-что. Успех компании зависит от качества инженеров. Лучший способ сэкономить — нанять крутых спецов. Они стоят дороже, но их продуктивность выше в разы. Но есть нюанс: хорошие инженеры ненавидят работать в помойке. Если слух о вашем гнилом коде пойдет по рынку (а он пойдет), вы сможете нанять только тех, кого больше никуда не берут. И они сделают ваш код еще хуже.

Пример: Facebook. Долгие годы их девиз был **«Move fast and break things»** (Двигайся быстро и круши всё вокруг). Они поощряли тактическое программирование и Тактических Торнадо. Код писали вчерашние студенты, сразу в прод.
Да, Facebook успешен. Но их кодовая база превратилась в ад. Нестабильный, непонятный код, ноль тестов, ноль комментов. В итоге им пришлось признать, что так жить нельзя, и сменить девиз на «Move fast with stable infra» (Двигайся быстро, но не будь долбоебом). Смогут ли они разгрести эти авгиевы конюшни — большой вопрос.

Для сравнения: Google и VMware. Они росли в то же время, но выбрали стратегический подход. Высокое качество кода, хороший дизайн. Итог? У них одни из лучших инженерных культур в мире, и все хотят там работать.

Короче, можно стать успешным и с говнокодом (если повезет), но работать в компании, где код не вызывает рвотных позывов, гораздо приятнее.

## **3.5 Итог**

Хороший дизайн не дается бесплатно. Это постоянные усилия. Но он окупается.

Главное правило: **будь стратегом всегда**. Не откладывай «чистку» на завтра. Когда у тебя аврал, велик соблазн сказать «почищу после релиза». Это ловушка. За этим авралом будет следующий. Как только ты начнешь откладывать дизайн, ты уже проиграл. Проблемы будут копиться, рефакторинг станет пугающим, и ты забьешь на него окончательно.

Единственный выход — каждый день, по чуть-чуть, делать код лучше, чем он был вчера.