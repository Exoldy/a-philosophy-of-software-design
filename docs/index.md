<img src="./cover.jpg" style="width: 38%" />

## A Philosophy of Software Design, 2nd Edition

# **АРХИТЕКТУРА И ДИЗАЙН СОФТА**

### **(Или «Философия того, как не написать кусок говна»)**

**Оригинальное название:** A Philosophy of Software Design

**Автор:** Джон Оустерхаут (*John Ousterhout*) — тот самый мужик, который шарит, в отличие от твоего тимлида.

## Что мы видим на обложке?

Перед нами, дамы и господа, **«Software Design»**.

Или, говоря простым русским языком: **Лютый пиздец из синих проводов**.

Эта абстракция идеально, сука, точно передает состояние любой кодовой базы через полгода после старта проекта. Этот запутанный клубок — это твой легаси-код, в котором «всего лишь надо поправить одну константу», и в итоге падает прод в трех регионах. Это визуализация того, что происходит в голове у сеньора, когда джун спрашивает: «А почему мы не можем просто заюзать тут глобальную переменную?».

## Суть (краткий спойлер)

Книга о том, что главная проблема программирования — это **сложность**. И если ты не будешь бороться со сложностью, сложность тебя выебет. Оустерхаут пытается объяснить, как нарезать систему на модули так, чтобы они не выглядели как этот синий клубок на обложке, а напоминали что-то инженерное.

## Оглавление (Или карта минного поля)

**Предисловие:** На кой хрен я это написал.

**1. Введение:** Вход в кроличью нору.

* 1.1 Как юзать этот мануал (чтобы не облажаться).

**2. Суть всей боли (Природа Сложности)**

* 2.1 Чё это такое вообще (Определение).
* 2.2 Симптомы (Как понять, что вы в глубокой жопе).
* 2.3 Кто виноват и что делать (Причины).
* 2.4 Почему оно растет как снежный ком (Сложность инкрементальна, сука).
* 2.5 Итог: Жизнь — боль.

**3. "Работает — и ладно" — девиз неудачников (Код в работе)**

* 3.1 Тактическое программирование: "Хуяк-хуяк и в продакшн".
* 3.2 Стратегическое программирование: Для тех, кто планирует жить вечно.
* 3.3 Сколько времени на это убить? (Инвестируем в будущее или экономим на спичках).
* 3.4 Стартапы и инвесторы (Почему им похер на твой красивый код).
* 3.5 Итог.

**4. Глубокие модули (Интерфейсы должны быть простыми, как палка)**

* 4.1 Модульный дизайн: Разделяй и властвуй.
* 4.2 Чё там внутри интерфейса?
* 4.3 Абстракции (или как врать во благо).
* 4.4 Глубокие модули (Deep Modules) — наш бро.
* 4.5 Мелкие модули (Shallow Modules) — бесполезная херня.
* 4.6 "Классит" (Classitis): Болезнь плодить классы на каждый чих.
* 4.7 Примеры: Java (как не надо) и Unix I/O (как надо).
* 4.8 Итог.

**5. Прячем говно под ковер (Сокрытие информации и утечки)**

* 5.1 Сокрытие информации (Инкапсуляция для взрослых).
* 5.2 Утечки информации (Когда кишки торчат наружу).
* 5.3 Временная декомпозиция (Зло во плоти).
* 5.4 Пример: HTTP сервер (Разбор полетов).
* 5.5 Пример: Слишком дохера классов.
* 5.6 Пример: Обработка параметров HTTP.
* 5.7 Пример: Дефолтные значения в ответах.
* 5.8 Прячем инфу внутри класса.
* 5.9 Когда перегнул палку (Заставь дурака богу молиться...).
* 5.10 Итог.

**6. Универсальность модулей (General Purpose)**

* 6.1 Делай классы универсальными (General-purpose, а не one-off shit).
* 6.2 Пример: Хранение текста в редакторе.
* 6.3 Более общие интерфейсы.
* 6.4 Обобщение помогает лучше прятать кишки.
* 6.5 Вопросы к самому себе (Ты точно не идиот?).
* 6.6 Итог.

**7. Разные слои — разные абстракции**

* 7.1 Методы-курьеры (Pass-through methods): "Я просто передам это дальше". (Бесполезная херня).
* 7.2 Когда дублировать интерфейс — это ок? (Спойлер: редко).
* 7.3 Декораторы (Decorators): Паттерн, которым вы злоупотребляете.
* 7.4 Интерфейс vs Реализация: Вечная битва.
* 7.5 Переменные-курьеры: Передаем мусор по цепочке вызовов.
* 7.6 Итог.

**8. Скидывай сложность вниз (Pull Complexity Downwards)**

* 8.1 Пример: Текстовый редактор (Как сделать удобно).
* 8.2 Пример: Параметры конфигурации (Админ разберется... или нет).
* 8.3 Когда перегнул палку (Не надо делать из модуля чёрную дыру).
* 8.4 Итог.

**9. Вместе или порознь? (Сплитить или мержить?)**

* 9.1 Инфа общая? Объединяй, не тупи.
* 9.2 Это упростит интерфейс? Объединяй.
* 9.3 Дублируется код? Объединяй.
* 9.4 Разделяй универсальное и специфичное (Мухи отдельно, котлеты отдельно).
* 9.5 Пример: Курсор и Выделение текста.
* 9.6 Пример: Отдельный класс для логов (Нахрена?).
* 9.7 Пример: Механизм Undo (Отмена действий — это боль).
* 9.8 Разделение и слияние методов.
* 9.9 Итог.

**10. Ошибок не существует (Define Errors Out of Existence)**

* 10.1 Почему Exception увеличивает сложность (Потому что ты их не обрабатываешь).
* 10.2 Слишком дохера исключений.
* 10.3 Спроектируй так, чтобы ошибки не возникали.
* 10.4 Пример: Удаление файла в Windows (Ад) vs Unix (Рай).
* 10.5 Пример: Java substring (Как выстрелить себе в ногу).
* 10.6 Маскировка исключений (Типа ничего не случилось).
* 10.7 Агрегация исключений.
* 10.8 А может, просто крашнуться? (Иногда лучше сдохнуть сразу).
* 10.9 Убираем "особые случаи" (Special cases).
* 10.10 Taking it too far.
* 10.11 Итог.

**11. Проектируй дважды (Design it Twice)**

*(Потому что твоя первая идея — говно)*

**12. Зачем писать комменты? 4 причины (Продолжение)**

* 12.1 "Хороший код документирует сам себя" — Пиздёж.
* 12.2 "У меня нет времени" — Отмазка для ленивых.
* 12.3 "Комменты устаревают и врут" — Так обновляй их, сука!
* 12.4 "Я видел код, где комменты — мусор" (Ну так не пиши мусор).
* 12.5 Профит от нормальной писанины.

**13. Комментируй то, что не очевидно**

* 13.1 Выбери стиль (Convention) и не выпендривайся.
* 13.2 Не дублируй код словами (Мы и так умеем читать i++).
* 13.3 Низкоуровневая точность (Для особо сложных мест).
* 13.4 Высокоуровневая интуиция (О чем вообще этот кусок говна).
* 13.5 Документация интерфейсов.
* 13.6 Пиши ЧТО и ПОЧЕМУ, а не КАК (Как — я и в коде вижу).
* 13.7 Решения, размазанные по модулям (Cross-module design).
* 13.8 Итог.
* 13.9 Ответы на вопросы (FAQ для тех, кто не понял с первого раза).

**14. Нейминг (Самая сложная проблема в Computer Science)**

* 14.1 Пример: Как кривое имя создает баги и дыры в безопасности.
* 14.2 Рисуй картинку в голове (Создавай образ, а не абстракцию).
* 14.3 Имя должно быть точным (Precise).
* 14.4 Последовательность (Consistency) — наше всё.
* 14.5 Отдельное мнение: Go Style Guide (Там свои приколы с короткими именами).
* 14.6 Итог.

**15. Сначала комменты, потом код**

* 15.1 "Напишу комменты потом" = "Не напишу никогда".
* 15.2 Пиши комменты ДО кода.
* 15.3 Комментарии как инструмент дизайна (Думай, прежде чем кодить).
* 15.4 Ранние комменты — это весело (Ну, почти).
* 15.5 Дорого ли это? (Нет, переписывать говнокод дороже).
* 15.6 Итог.

**16. Трогаем старый код (Некромантия и Рефакторинг)**

* 16.1 Оставайся стратегом (Не скатывайся в "лишь бы заработало").
* 16.2 Держи комменты рядом с кодом (А не в голове или в Jira).
* 16.3 Комменты принадлежат коду, а не логам коммитов (Git blame не спасет).
* 16.4 Избегай дублирования (DRY в документации тоже работает).
* 16.5 Проверяй дифы (Check diffs): Не будь животным, смотри, что комитишь.
* 16.6 Высокоуровневые комменты проще поддерживать.

**17. Консистентность (Единообразие)**

* 17.1 Примеры консистентности.
* 17.2 Как обеспечить единообразие (Бить линейкой по рукам).
* 17.3 Когда ты превращаешься в фашиста стайлгайдов (Taking it too far).
* 17.4 Итог.

**18. Код должен быть понятен даже ежу**

*(И твоему будущему похмельному 'я')*

* 18.1 Сделай код очевидным (Кэп спешит на помощь).
* 18.2 Сделай код неочевидным (И попади в Ад).
* 18.3 Итог.

**19. Модные молодежные тренды**

*(И почему они не спасут твой говнокод)*

* 19.1 ООП и Наследование (Когда абстракций больше, чем смысла).
* 19.2 Agile (Религия стикеров и бесполезных митингов).
* 19.3 Unit Tests (Если тестов нет — ты не инженер, ты ковбой).
* 19.4 TDD (Секта свидетелей Красного и Зеленого).
* 19.5 Паттерны (Карго-культ для архитекторов).
* 19.6 Геттеры и сеттеры (Бессмысленный шум).
* 19.7 Итог.

**20. Производительность (Performance)**

*(Чтобы не тормозило как жигули)*

* 20.1 Как вообще думать о перформансе (Не оптимизируй преждевременно, но и не будь тормозом).
* 20.2 Сначала замерь, потом меняй (Measure twice, cut once).
* 20.3 Дизайн вокруг критического пути (Узкое горлышко бутылки).
* 20.4 Пример: Буфер RAMCloud.
* 20.5 Итог.

**21. Заключение**

*(Ты дочитал? Возьми с полки пирожок).*

## Итого

**Краткое резюме принципов дизайна** (Шпаргалка).

**Об авторе** (Кто этот святой человек).

*Приятного чтения. Готовься переписывать всё, что ты накодил за последние два года.*
